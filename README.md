# yolo11-train

> YOLOv5、YOLOv8、YOLOv11 预训练模型一览

| **任务**                              | **模型版本** | **模型名称**    | **预训练模型链接**                                           |
| ------------------------------------- | ------------ | --------------- | ------------------------------------------------------------ |
| **分类（Image Classification）**      | YOLOv5       | yolov5n-cls.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5n-cls.pt |
|                                       |              | yolov5s-cls.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5s-cls.pt |
|                                       |              | yolov5m-cls.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5m-cls.pt |
|                                       |              | yolov5l-cls.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5l-cls.pt |
|                                       |              | yolov5x-cls.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5x-cls.pt |
|                                       | YOLOv8       | yolov8n-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8n-cls.pt |
|                                       |              | yolov8s-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8s-cls.pt |
|                                       |              | yolov8m-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8m-cls.pt |
|                                       |              | yolov8l-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8l-cls.pt |
|                                       |              | yolov8x-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8x-cls.pt |
|                                       | YOLOv11      | yolo11n-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11n-cls.pt |
|                                       |              | yolo11s-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11s-cls.pt |
|                                       |              | yolo11m-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11m-cls.pt |
|                                       |              | yolo11l-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11l-cls.pt |
|                                       |              | yolo11x-cls.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11x-cls.pt |
| **目标检测（Object Detection）**      | YOLOv5       | yolov5n.pt      | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5n.pt |
|                                       |              | yolov5s.pt      | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5s.pt |
|                                       |              | yolov5m.pt      | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5m.pt |
|                                       |              | yolov5l.pt      | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5l.pt |
|                                       |              | yolov5x.pt      | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5x.pt |
|                                       | YOLOv8       | yolov8n.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8n.pt |
|                                       |              | yolov8s.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8s.pt |
|                                       |              | yolov8m.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8m.pt |
|                                       |              | yolov8l.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8l.pt |
|                                       |              | yolov8x.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8x.pt |
|                                       | YOLOv11      | yolo11n.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11n.pt |
|                                       |              | yolo11s.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11s.pt |
|                                       |              | yolo11m.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11m.pt |
|                                       |              | yolo11l.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11l.pt |
|                                       |              | yolo11x.pt      | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11x.pt |
| **实例分割（Instance Segmentation）** | YOLOv5       | yolov5n-seg.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5n-seg.pt |
|                                       |              | yolov5s-seg.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5s-seg.pt |
|                                       |              | yolov5m-seg.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5m-seg.pt |
|                                       |              | yolov5l-seg.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5l-seg.pt |
|                                       |              | yolov5x-seg.pt  | https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5x-seg.pt |
|                                       | YOLOv8       | yolov8n-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8n-seg.pt |
|                                       |              | yolov8s-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8s-seg.pt |
|                                       |              | yolov8m-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8m-seg.pt |
|                                       |              | yolov8l-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8l-seg.pt |
|                                       |              | yolov8x-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8x-seg.pt |
|                                       | YOLOv11      | yolo11n-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11n-seg.pt |
|                                       |              | yolo11s-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11s-seg.pt |
|                                       |              | yolo11m-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11m-seg.pt |
|                                       |              | yolo11l-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11l-seg.pt |
|                                       |              | yolo11x-seg.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11x-seg.pt |
| **旋转目标检测（OBB）**               | YOLOv5       | 不支持          | -                                                            |
|                                       | YOLOv8       | yolov8n-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8n-obb.pt |
|                                       |              | yolov8s-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8s-obb.pt |
|                                       |              | yolov8m-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8m-obb.pt |
|                                       |              | yolov8l-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8l-obb.pt |
|                                       |              | yolov8x-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8x-obb.pt |
|                                       | YOLOv11      | yolo11n-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11n-obb.pt |
|                                       |              | yolo11s-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11s-obb.pt |
|                                       |              | yolo11m-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11m-obb.pt |
|                                       |              | yolo11l-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11l-obb.pt |
|                                       |              | yolo11x-obb.pt  | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11x-obb.pt |
| **关键点检测（Keypoint Detection）**  | YOLOv5       | 不支持          | -                                                            |
|                                       | YOLOv8       | yolov8n-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8n-pose.pt |
|                                       |              | yolov8s-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8s-pose.pt |
|                                       |              | yolov8m-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8m-pose.pt |
|                                       |              | yolov8l-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8l-pose.pt |
|                                       |              | yolov8x-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov8x-pose.pt |
|                                       | YOLOv11      | yolo11n-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11n-pose.pt |
|                                       |              | yolo11s-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11s-pose.pt |
|                                       |              | yolo11m-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11m-pose.pt |
|                                       |              | yolo11l-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11l-pose.pt |
|                                       |              | yolo11x-pose.pt | https://github.com/ultralytics/assets/releases/download/v8.2.0/yolo11x-pose.pt |

## 配置训练环境

### 1. YOLOv8/YOLOv11 环境配置

修改文件`environment.yml`中的`prefix`并创建环境

```shell
conda env create -f environment.yml
```

### 2. YOLOv5 环境配置

1. **创建 Conda 环境**：
   - 创建环境：
     ```shell
     conda create -n yolov5 python=3.8
     ```
   - 激活环境：
     ```shell
     conda activate yolov5
     ```

2. **安装 YOLOv5 代码库**：
   - 克隆 YOLOv5 仓库到项目目录：
     ```shell
     cd ~
     git clone https://github.com/ultralytics/yolov5
     cd yolov5
     pip install -r requirements.txt
     ```

3. **安装兼容的 PyTorch 版本**：
   - YOLOv5 可能需要较旧的 PyTorch（建议 1.7 或 1.8）：
     ```shell
     pip show torch
     pip install torch==1.8.1 torchvision==0.9.1
     ```


## 标注数据

使用 [X-AnyLabeling](https://github.com/CVHub520/X-AnyLabeling.git) 标注数据

- **创建环境**：安装参考 [快速入门指南](https://github.com/CVHub520/X-AnyLabeling/blob/main/docs/zh_cn/get_started.md)
- **标注**：略
- **导出标签**：
  - 导出 YOLO 水平框标签
  - 导出 YOLO 旋转框标签
  - 导出 YOLO 分割标签
  - 导出 YOLO 关键点标签

> **注意**：导出 YOLO 水平框标签、旋转框标签、分割标签选择 `classes.txt` 文件，关键点标签选择 `pose_classes.yaml` 文件。

`classes.txt` 示例：
```shell
wirerope
```

`pose_classes.yaml` 示例：
```shell
has_visible: true
classes:
  rack:
    - k1
    - k2
  block:
    - p1
    - p2
```

导出后的标签文件在 `labels` 文件夹下，格式为 `**.txt`。

## 训练

### 1. 组织训练文件
- 将所有图像数据拷贝至 `/home/zja/Develop/yolo11-train/data_sets/Origin_dataset/images`，标注的标签数据拷贝至 `/home/zja/Develop/yolo11-train/data_sets/Origin_dataset/labels`，图像与标签文件名一一对应。
- 将 `pose_classes.yaml` 拷贝至 `/home/zja/Develop/yolo11-train/data_sets/Origin_dataset`。

### 2. 训练 YOLOv8/YOLOv11
- **修改脚本**：
  - 编辑 `train_v8v11.py`，设置 `class_names`（例如 `['wirerope']`）、`tasks`（例如 `['segment']`）、`yolo_versions`（例如 `['yolov8', 'yolo11']`）、`model_sizes`（例如 `['n']`）。
- **运行训练**：
  - 激活环境：
    ```shell
    conda activate yolov8v11
    ```
  - 运行：
    ```shell
    cd yolo11-train
    python train_v8v11.py
    ```
  - 脚本将自动下载预训练模型（如 `yolov8n-seg.pt`）并开始训练。

### 3. 训练 YOLOv5
> TODO
- **修改脚本**：
  - 编辑 `train_v5.py`，设置 `class_names`（例如 `['wirerope']`）、`tasks`（例如 `['segment']`）、`yolo_versions`（`['yolov5']`）、`model_sizes`（例如 `['n']`）。
- **运行训练**：
  - 激活环境：
    ```shell
    conda activate yolov5
    ```
  - 确保 YOLOv5 代码库已安装（见“YOLOv5 环境配置”）。
  - 运行：
    ```shell
    cd yolo11-train
    python train_v5.py
    ```
  - 脚本将自动下载预训练模型（如 `yolov5n-seg.pt`）并开始训练。

## 提取模型

- **模型路径**：
  - 训练后的模型保存在 `/home/zja/Develop/yolo11-train/runs/任务/train*/weights/`。
  - `.onnx` 文件（例如 `best.onnx`）用于 C++ 部署，参考 [yolo11-onnx-cpp](https://github.com/zhangnatha/yolo11-onnx-cpp.git)。
  - `.pt` 文件（例如 `best.pt`）用于 Python 部署。
